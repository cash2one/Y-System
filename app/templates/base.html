<!DOCTYPE html>
<html>
<head>
    {% block head %}
    <!-- Standard Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />

    <!-- Site Properties -->
    <title>{% block title %}{% endblock %} &middot;{% if current_user.is_authenticated %} {{ current_user.name }} &middot;{% endif %} 云英语</title>
    <meta name="author" content="iROCKBUNNY" />
    <meta name="description" content="Y-System: Y-English Education Service Support System" />
    <meta name="keywords" content="Y-English, Y-System, English, Education" />

    <!-- Semantic UI CSS -->
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.css">

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Customized CSS -->
    {% block customized_styles %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/customize.css') }}">
    {% endblock %}

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <!-- Baidu Analytics -->
    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?e1020f74ced8efa6683361c79e6de835";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    <!-- Google Analytics -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-84829010-1', 'auto');
        ga('send', 'pageview');
    </script>

    <!-- Piwik -->
    <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(["setDomains", ["*.y-english.org"]]);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="//dev.y-english.org/analytics/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', '1']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <noscript><p><img src="//dev.y-english.org/analytics/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
    <!-- End Piwik Code -->
    {% endblock %}
</head>
<body>
    {% block body %}
    <!-- Following Menu -->
    <div class="ui large top fixed borderless hidden menu">
        <div class="ui container">
            <div class="item logo">
                <img class="ui logo image" src="{{ url_for('static', filename='images/logo-dark.png') }}">
                <span>云英语</span>
            </div>
            {% if current_user.is_authenticated %}
            {% if current_user.can('管理') %}
            <a class="item loading-trigger" href="{{ url_for('manage.summary') }}"><i class="dashboard icon"></i> 系统实况</a>
            {% else %}
            <a class="item loading-trigger" href="{{ url_for('main.profile') }}"><i class="archive icon"></i> 个人档案</a>
            {% endif %}
            {% else %}
            <a class="item loading-trigger" href="{{ url_for('main.index') }}"><i class="home icon"></i> 首页</a>
            <a class="item" href="{{ url_for('main.index') }}#products"><i class="lightbulb icon"></i> 解决方案</a>
            {% endif %}
            {% if current_user.can('预约') %}
            <div class="ui dropdown item">
                <i class="calendar icon"></i>
                课程预约
                <i class="dropdown icon"></i>
                <div class="menu">
                    {% if current_user.can('预约VB课程') %}
                    <a class="item loading-trigger" href="{{ url_for('book.vb') }}"><i class="add to calendar icon"></i> 预约VB课程</a>
                    {% endif %}
                    {% if current_user.can('预约Y-GRE课程') %}
                    <a class="item loading-trigger" href="{{ url_for('book.y_gre') }}"><i class="add to calendar icon"></i> 预约Y-GRE课程</a>
                    {% endif %}
                </div>
            </div>
            {% endif %}
            {% if current_user.can('管理') %}
            <div class="ui dropdown item">
                <i class="student icon"></i>
                教学管理
                <i class="dropdown icon"></i>
                <div class="menu">
                    {% if current_user.can('管理课程预约') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.booking') }}"><i class="calendar icon"></i> 预约管理</a>
                    {% endif %}
                    {% if current_user.can('管理预约时段') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.schedule') }}"><i class="wait icon"></i> 时段管理</a>
                    {% endif %}
                    {% if current_user.can('管理iPad借阅') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.rental') }}"><i class="exchange icon"></i> iPad借阅管理</a>
                    {% endif %}
                    {% if current_user.can('管理作业') %}
                    <a class="item loading-trigger" href="#"><i class="file text outline icon"></i> 作业管理</a>
                    {% endif %}
                    {% if current_user.can('管理考试') %}
                    <a class="item loading-trigger" href="#"><i class="write icon"></i> 考试管理</a>
                    {% endif %}
                </div>
            </div>
            <div class="ui dropdown item">
                <i class="settings icon"></i>
                系统管理
                <i class="dropdown icon"></i>
                <div class="menu">
                    <a class="item loading-trigger" href="{{ url_for('manage.ipad') }}"><i class="tablet icon"></i> iPad管理</a>
                    {% if current_user.can('管理通知') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.announcement') }}"><i class="announcement icon"></i> 通知管理</a>
                    {% endif %}
                    {% if current_user.can('管理用户') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.user') }}"><i class="users icon"></i> 用户管理</a>
                    {% endif %}
                    {% if current_user.can('管理班级') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.course') }}"><i class="student icon"></i> 班级管理</a>
                    {% endif %}
                    {% if current_user.is_developer%}
                    <div class="divider"></div>
                    <a class="item loading-trigger" href="#"><i class="bomb icon"></i> 开发权限</a>
                    {% endif %}
                </div>
            </div>
            <div class="ui dropdown item">
                <i class="search icon"></i>
                查询功能
                <i class="dropdown icon"></i>
                <div class="menu">
                    <a class="item loading-trigger" href="{{ url_for('manage.find_user') }}"><i class="find icon"></i> 检索用户</a>
                    <a class="item loading-trigger" href="{{ url_for('manage.filter_ipad') }}"><i class="filter icon"></i> 筛选iPad</a>
                    <a class="item loading-trigger" href="{{ url_for('manage.ipad_contents') }}"><i class="table icon"></i> iPad内容排布表</a>
                    <a class="item loading-trigger" href="{{ url_for('manage.analytics') }}"><i class="line chart icon"></i> 访客分析</a>
                </div>
            </div>
            {% endif %}
            {% block following_menu %}
            {% endblock %}
            {% block following_menu_auth %}
            {% if current_user.is_authenticated %}
            <div class="ui right dropdown item">
                <i class="user icon"></i>
                {% if current_user.can('管理') %}
                {{ current_user.name }} [{{ current_user.role.name }}]
                {% else %}
                {{ current_user.name }}
                {% endif %}
                <i class="dropdown icon"></i>
                <div class="menu">
                    {% if current_user.can('管理') %}
                    <a class="item loading-trigger" href="{{ url_for('main.profile') }}"><i class="archive icon"></i> 个人档案</a>
                    <div class="divider"></div>
                    {% endif %}
                    <div class="header">账户设置</div>
                    <a class="item loading-trigger" href="{{ url_for('auth.change_email_request') }}"><i class="at icon"></i> 修改邮箱</a>
                    <a class="item loading-trigger" href="{{ url_for('auth.change_password') }}"><i class="lock icon"></i> 修改密码</a>
                    <div class="divider"></div>
                    <a class="item loading-trigger" href="{{ url_for('auth.logout') }}"><i class="sign out icon"></i> 退出</a>
                </div>
            </div>
            {% else %}
            <a class="right item loading-trigger" href="{{ url_for('auth.login') }}"><i class="sign in icon"></i> 登录</a>
            {% endif %}
            {% endblock %}
        </div>
    </div>

    <!-- Sidebar Menu -->
    <div class="ui vertical inverted sidebar menu">
        <div class="item">
            <h2 class="ui center aligned inverted header">
                <img class="ui mini image" src="{{ url_for('static', filename='images/logo-white.png') }}">
                <div class="content">云英语</div>
            </h2>
        </div>
        {% if current_user.is_authenticated %}
        {% if current_user.can('管理') %}
        <a class="item loading-trigger" href="{{ url_for('manage.summary') }}"><i class="dashboard icon"></i> 系统实况</a>
        {% else %}
        <a class="item loading-trigger" href="{{ url_for('main.profile') }}"><i class="archive icon"></i> 个人档案</a>
        {% endif %}
        {% else %}
        <a class="item loading-trigger" href="{{ url_for('main.index') }}"><i class="home icon"></i> 首页</a>
        <a class="item" href="{{ url_for('main.index') }}#products"><i class="lightbulb icon"></i> 解决方案</a>
        {% endif %}
        {% if current_user.can('预约') %}
        <div class="item">
            <div class="header">课程预约</div>
            <div class="menu">
                {% if current_user.can('预约VB课程') %}
                <a class="item loading-trigger" href="{{ url_for('book.vb') }}"><i class="add to calendar icon"></i> 预约VB课程</a>
                {% endif %}
                {% if current_user.can('预约Y-GRE课程') %}
                <a class="item loading-trigger" href="{{ url_for('book.y_gre') }}"><i class="add to calendar icon"></i> 预约Y-GRE课程</a>
                {% endif %}
            </div>
        </div>
        {% endif %}
        {% if current_user.can('管理') %}
        <div class="item">
            <div class="header">教学管理</div>
            <div class="menu">
                {% if current_user.can('管理课程预约') %}
                <a class="item loading-trigger" href="{{ url_for('manage.booking') }}"><i class="calendar icon"></i> 预约管理</a>
                {% endif %}
                {% if current_user.can('管理预约时段') %}
                <a class="item loading-trigger" href="{{ url_for('manage.schedule') }}"><i class="wait icon"></i> 时段管理</a>
                {% endif %}
                {% if current_user.can('管理iPad借阅') %}
                <a class="item loading-trigger" href="{{ url_for('manage.rental') }}"><i class="exchange icon"></i> iPad借阅管理</a>
                {% endif %}
                {% if current_user.can('管理作业') %}
                <a class="item loading-trigger" href="#"><i class="file text outline icon"></i> 作业管理</a>
                {% endif %}
                {% if current_user.can('管理考试') %}
                <a class="item loading-trigger" href="#"><i class="write icon"></i> 考试管理</a>
                {% endif %}
            </div>
        </div>
        <div class="item">
            <div class="header">系统管理</div>
            <div class="menu">
                <a class="item loading-trigger" href="{{ url_for('manage.ipad') }}"><i class="tablet icon"></i> iPad管理</a>
                {% if current_user.can('管理通知') %}
                <a class="item loading-trigger" href="{{ url_for('manage.announcement') }}"><i class="announcement icon"></i> 通知管理</a>
                {% endif %}
                {% if current_user.can('管理用户') %}
                <a class="item loading-trigger" href="{{ url_for('manage.user') }}"><i class="users icon"></i> 用户管理</a>
                {% endif %}
                {% if current_user.can('管理班级') %}
                <a class="item loading-trigger" href="{{ url_for('manage.course') }}"><i class="student icon"></i> 班级管理</a>
                {% endif %}
                {% if current_user.is_developer%}
                <a class="item loading-trigger" href="#"><i class="bomb icon"></i> 开发权限</a>
                {% endif %}
            </div>
        </div>
        <div class="item">
            <div class="header">查询功能</div>
            <div class="menu">
                <a class="item loading-trigger" href="{{ url_for('manage.find_user') }}"><i class="find icon"></i> 检索用户</a>
                <a class="item loading-trigger" href="{{ url_for('manage.filter_ipad') }}"><i class="filter icon"></i> 筛选iPad</a>
                <a class="item loading-trigger" href="{{ url_for('manage.ipad_contents') }}"><i class="table icon"></i> iPad内容排布表</a>
                <a class="item loading-trigger" href="{{ url_for('manage.analytics') }}"><i class="line chart icon"></i> 访客分析</a>
            </div>
        </div>
        {% endif %}
        {% block sidebar_menu %}
        {% endblock %}
        {% block sidebar_menu_auth %}
        {% if current_user.is_authenticated %}
        {% if current_user.can('管理') %}
        <a class="item loading-trigger" href="{{ url_for('main.profile') }}"><i class="archive icon"></i> 个人档案</a>
        {% endif %}
        <div class="item">
            <div class="header">账户设置</div>
            <div class="menu">
                <a class="item loading-trigger" href="{{ url_for('auth.change_email_request') }}"><i class="at icon"></i> 修改邮箱</a>
                <a class="item loading-trigger" href="{{ url_for('auth.change_password') }}"><i class="lock icon"></i> 修改密码</a>
            </div>
        </div>
        <div class="divider"></div>
        <a class="item loading-trigger" href="{{ url_for('auth.logout') }}"><i class="sign out icon"></i> 退出</a>
        {% else %}
        <a class="item loading-trigger" href="{{ url_for('auth.login') }}"><i class="sign in icon"></i> 登录</a>
        {% endif %}
        {% endblock %}
    </div>

    <!-- Page Contents -->
    <div class="pusher">
        <div class="ui inverted vertical masthead center aligned segment">
            <div class="ui container">
                <div class="ui large borderless inverted menu">
                    <a class="toc item"><i class="sidebar icon"></i></a>
                    <div class="item logo">
                        <img class="ui logo image" src="{{ url_for('static', filename='images/logo-white.png') }}">
                        <span>云英语</span>
                    </div>
                    {% if current_user.is_authenticated %}
                    {% if current_user.can('管理') %}
                    <a class="item loading-trigger" href="{{ url_for('manage.summary') }}"><i class="dashboard icon"></i> 系统实况</a>
                    {% else %}
                    <a class="item loading-trigger" href="{{ url_for('main.profile') }}"><i class="archive icon"></i> 个人档案</a>
                    {% endif %}
                    {% else %}
                    <a class="item loading-trigger" href="{{ url_for('main.index') }}"><i class="home icon"></i> 首页</a>
                    <a class="item" href="{{ url_for('main.index') }}#products"><i class="lightbulb icon"></i> 解决方案</a>
                    {% endif %}
                    {% if current_user.can('预约') %}
                    <div class="ui dropdown item">
                        <i class="calendar icon"></i>
                        课程预约
                        <i class="dropdown icon"></i>
                        <div class="menu">
                            {% if current_user.can('预约VB课程') %}
                            <a class="item loading-trigger" href="{{ url_for('book.vb') }}"><i class="add to calendar icon"></i> 预约VB课程</a>
                            {% endif %}
                            {% if current_user.can('预约Y-GRE课程') %}
                            <a class="item loading-trigger" href="{{ url_for('book.y_gre') }}"><i class="add to calendar icon"></i> 预约Y-GRE课程</a>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                    {% if current_user.can('管理') %}
                    <div class="ui dropdown item">
                        <i class="student icon"></i>
                        教学管理
                        <i class="dropdown icon"></i>
                        <div class="menu">
                            {% if current_user.can('管理课程预约') %}
                            <a class="item loading-trigger" href="{{ url_for('manage.booking') }}"><i class="calendar icon"></i> 预约管理</a>
                            {% endif %}
                            {% if current_user.can('管理预约时段') %}
                            <a class="item loading-trigger" href="{{ url_for('manage.schedule') }}"><i class="wait icon"></i> 时段管理</a>
                            {% endif %}
                            {% if current_user.can('管理iPad借阅') %}
                            <a class="item loading-trigger" href="{{ url_for('manage.rental') }}"><i class="exchange icon"></i> iPad借阅管理</a>
                            {% endif %}
                            {% if current_user.can('管理作业') %}
                            <a class="item loading-trigger" href="#"><i class="file text outline icon"></i> 作业管理</a>
                            {% endif %}
                            {% if current_user.can('管理考试') %}
                            <a class="item loading-trigger" href="#"><i class="write icon"></i> 考试管理</a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="ui dropdown item">
                        <i class="settings icon"></i>
                        系统管理
                        <i class="dropdown icon"></i>
                        <div class="menu">
                            <a class="item loading-trigger" href="{{ url_for('manage.ipad') }}"><i class="tablet icon"></i> iPad管理</a>
                            {% if current_user.can('管理通知') %}
                            <a class="item loading-trigger" href="{{ url_for('manage.announcement') }}"><i class="announcement icon"></i> 通知管理</a>
                            {% endif %}
                            {% if current_user.can('管理用户') %}
                            <a class="item loading-trigger" href="{{ url_for('manage.user') }}"><i class="users icon"></i> 用户管理</a>
                            {% endif %}
                            {% if current_user.can('管理班级') %}
                            <a class="item loading-trigger" href="{{ url_for('manage.course') }}"><i class="student icon"></i> 班级管理</a>
                            {% endif %}
                            {% if current_user.is_developer%}
                            <div class="divider"></div>
                            <a class="item loading-trigger" href="#"><i class="bomb icon"></i> 开发权限</a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="ui dropdown item">
                        <i class="search icon"></i>
                        查询功能
                        <i class="dropdown icon"></i>
                        <div class="menu">
                            <a class="item loading-trigger" href="{{ url_for('manage.find_user') }}"><i class="find icon"></i> 检索用户</a>
                            <a class="item loading-trigger" href="{{ url_for('manage.filter_ipad') }}"><i class="filter icon"></i> 筛选iPad</a>
                            <a class="item loading-trigger" href="{{ url_for('manage.ipad_contents') }}"><i class="table icon"></i> iPad内容排布表</a>
                            <a class="item loading-trigger" href="{{ url_for('manage.analytics') }}"><i class="line chart icon"></i> 访客分析</a>
                        </div>
                    </div>
                    {% endif %}
                    {% block menu %}
                    {% endblock %}
                    {% block menu_auth %}
                    {% if current_user.is_authenticated %}
                    <div class="ui right dropdown item">
                        <i class="user icon"></i>
                        {% if current_user.can('管理') %}
                        {{ current_user.name }} [{{ current_user.role.name }}]
                        {% else %}
                        {{ current_user.name }}
                        {% endif %}
                        <i class="dropdown icon"></i>
                        <div class="menu">
                            {% if current_user.can('管理') %}
                            <a class="item loading-trigger" href="{{ url_for('main.profile') }}"><i class="archive icon"></i> 个人档案</a>
                            <div class="divider"></div>
                            {% endif %}
                            <div class="header">账户设置</div>
                            <a class="item loading-trigger" href="{{ url_for('auth.change_email_request') }}"><i class="at icon"></i> 修改邮箱</a>
                            <a class="item loading-trigger" href="{{ url_for('auth.change_password') }}"><i class="lock icon"></i> 修改密码</a>
                            <div class="divider"></div>
                            <a class="item loading-trigger" href="{{ url_for('auth.logout') }}"><i class="sign out icon"></i> 退出</a>
                        </div>
                    </div>
                    {% else %}
                    <a class="right item loading-trigger" href="{{ url_for('auth.login') }}"><i class="sign in icon"></i> 登录</a>
                    {% endif %}
                    {% endblock %}
                </div>
            </div>
            {% block page_masthead %}
            {% endblock %}
        </div>

        {% block page_content %}
        {% endblock %}

        <div class="ui inverted vertical footer segment">
            <div class="ui container">
                <div class="ui stackable inverted divided equal height stackable grid">
                    <div class="three wide column">
                        <h4 class="ui inverted header">技术支持</h4>
                        <div class="ui inverted link list">
                            <a class="item" href="http://semantic-ui.com/" target="_blank">Semantic UI</a>
                            <a class="item" href="http://flask.pocoo.org/" target="_blank">Flask</a>
                            <a class="item" href="https://www.aliyun.com/product/ecs/" target="_blank">阿里云ECS</a>
                        </div>
                    </div>
                    <div class="three wide column">
                        <h4 class="ui inverted header">关于我们</h4>
                        <div class="ui inverted link list">
                            <a id="contacts-footer-link" class="item"><i class="fa fa-phone fa-fw"></i> 400-876-3898</a>
                            <div id="contacts-dimmer" class="ui page dimmer">
                                <div class="content">
                                    <div class="ui center list">
                                        <div class="item"><i class="fa fa-phone fa-fw"></i> 400-876-3898</div>
                                        <div class="item">
                                            <i class="fa fa-at fa-fw"></i>
                                            <a href="mailto:service@y-english.org?subject=Mail From Y-System Website">service@y-english.org</a>
                                        </div>
                                        <div class="item">
                                            <i class="fa fa-map-marker fa-fw"></i>
                                            <a href="http://j.map.baidu.com/ukltC" target="_blank">北京 &middot; 海淀 &middot; 五道口 &middot; 华清商务会馆1707室</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <a id="wechat-qr-code-click" class="item"><i class="fa fa-wechat fa-fw"></i> 微信公众号</a>
                            <div id="wechat-qr-code" class="ui popup top left transition hidden">
                                <img class="ui medium image" src="{{ url_for('static', filename='images/qrcode/wechat.jpg') }}" alt="Wechat QR Code">
                            </div>
                        </div>
                    </div>
                    <div class="seven wide column">
                        <h4 class="ui inverted header">云英语教育服务支撑系统 &middot; Y-System</h4>
                        <div class="ui inverted link list">
                            <div id="copyright" class="item"></div>
                            <a class="item" href="http://www.miitbeian.gov.cn/" target="_blank"><i class="fa fa-shield fa-fw"></i> 京ICP备11017771号</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="loading-dimmer" class="ui page dimmer">
        <div class="ui loader"></div>
    </div>
    {% endblock %}

    {% block scripts %}
    <!-- jQuery -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-migrate/3.0.0/jquery-migrate.min.js"></script>

    <!-- Semantic UI JS -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.6/semantic.min.js"></script>

    <!-- Moment.js -->
    {{ moment.include_moment() }}
    {{ moment.locale('zh-CN') }}

    <!-- Customized JS -->
    {% block customized_scripts %}
    <script type="text/javascript" src="{{ url_for('static', filename='assets/js/customize.js') }}"></script>
    {% endblock %}

    {% endblock %}
</body>
</html>